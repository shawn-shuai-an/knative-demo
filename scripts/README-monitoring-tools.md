# ğŸ“Š æ¶ˆæ¯ç›‘æ§å·¥å…·å®Œæ•´æŒ‡å—

## ğŸ¯ **æ‚¨çš„åŸå§‹é—®é¢˜**

> "å¦‚ä½•æŸ¥çœ‹è¿™ä¸ªtopicé‡Œè¾¹çš„æ¶ˆæ¯å †ç§¯æˆ–è€…æ¶ˆè´¹é€Ÿåº¦å‘¢"

## ğŸš€ **ç›‘æ§å·¥å…·æ€»è§ˆ**

### **Dapr ç›‘æ§å·¥å…·ï¼ˆæ¨èç”¨äºæ¶ˆæ¯ç›‘æ§ï¼‰**

| å·¥å…·è„šæœ¬ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|---------|------|----------|
| `dapr-metrics-monitor.sh` | â­ **ä¸»æ¨è** - å®Œæ•´çš„DapræŒ‡æ ‡åˆ†æ | ç”Ÿäº§ç¯å¢ƒç›‘æ§ï¼Œæ€§èƒ½åˆ†æ |
| `monitor-redis-streams.sh` | Redis Stream åº•å±‚ç›‘æ§ | æ·±åº¦æ’æŸ¥ï¼Œéœ€è¦ redis-cli |
| `monitor-dapr-metrics.sh` | Kubernetes å±‚é¢ç›‘æ§ | åº”ç”¨å±‚ç›‘æ§ï¼ŒPodçŠ¶æ€æ£€æŸ¥ |
| `quick-monitor.sh` | å¿«é€ŸçŠ¶æ€æ£€æŸ¥ | æ—¥å¸¸å·¡æ£€ï¼Œé—®é¢˜åˆåˆ¤ |

### **Knative ç›‘æ§å·¥å…·ï¼ˆå¯¹æ¯”å‚è€ƒï¼‰**

| å·¥å…·è„šæœ¬ | åŠŸèƒ½ | è¯´æ˜ |
|---------|------|------|
| `knative-monitoring-demo.sh` | Knativeç›‘æ§èƒ½åŠ›æ¼”ç¤º | æŸ¥çœ‹Knativeç›‘æ§é™åˆ¶ |

## ğŸ“ˆ **å®é™…ä½¿ç”¨æŒ‡å—**

### **æœ€ä½³å®è·µï¼šDapr ç›‘æ§**

#### **1. å¿«é€Ÿæ£€æŸ¥æ¶ˆæ¯çŠ¶æ€**
```bash
# 30ç§’å†…äº†è§£æ¶ˆæ¯å †ç§¯å’Œæ¶ˆè´¹æƒ…å†µ
echo "4" | ./scripts/dapr-metrics-monitor.sh
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ“± Pod: dapr-simple-test-fixed
  æ€»å‘å¸ƒæ¶ˆæ¯æ•°: 53
  æ€»æ¥æ”¶æ¶ˆæ¯æ•°: 182
âš–ï¸  æ¶ˆæ¯æµé‡åˆ†æ:
  âœ… æ¶ˆè´¹é¢†å…ˆ: +129 (æ¥æ”¶å¤šäºå‘å¸ƒ)
  HTTP è¯·æ±‚æ€»æ•°: 194
```

#### **2. è¯¦ç»†æ€§èƒ½åˆ†æ**
```bash
# è·å¾—å®Œæ•´çš„å»¶è¿Ÿåˆ†å¸ƒå’Œæ€§èƒ½æŒ‡æ ‡
echo "1" | ./scripts/dapr-metrics-monitor.sh
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ“¤ å‘å¸ƒæŒ‡æ ‡ (Egress):
  æ€»å‘å¸ƒæ¶ˆæ¯æ•°: 53
  å‘å¸ƒå»¶è¿Ÿåˆ†å¸ƒ:
    â‰¤5ms: 53 æ¡
    â‰¤50ms: 53 æ¡

ğŸ“¥ æ¥æ”¶æŒ‡æ ‡ (Ingress):
  æ€»æ¥æ”¶æ¶ˆæ¯æ•°: 182
  æ¥æ”¶å¤„ç†å»¶è¿Ÿåˆ†å¸ƒ:
    â‰¤5ms: 123 æ¡
    â‰¤50ms: 182 æ¡

âš–ï¸  æ¶ˆæ¯æµé‡åˆ†æ:
  å‘å¸ƒæ€»æ•°: 53
  æ¥æ”¶æ€»æ•°: 182
  âœ… æ¶ˆè´¹é¢†å…ˆ: +129 (æ¥æ”¶å¤šäºå‘å¸ƒ)
```

#### **3. å®æ—¶ç›‘æ§**
```bash
# æŒç»­ç›‘æ§å…³é”®æŒ‡æ ‡
echo "2" | ./scripts/dapr-metrics-monitor.sh
```

#### **4. æ€§èƒ½åŸºå‡†æµ‹è¯•**
```bash
# 60ç§’æ€§èƒ½æµ‹è¯•
echo "3" | ./scripts/dapr-metrics-monitor.sh
```

### **å¤‡é€‰æ–¹æ¡ˆï¼šRedis ç›´æ¥ç›‘æ§**

```bash
# éœ€è¦å…ˆå®‰è£… redis-cli
brew install redis  # macOS
# æˆ–
apt-get install redis-tools  # Ubuntu

# ç„¶åä½¿ç”¨ Redis ç›‘æ§
./scripts/monitor-redis-streams.sh
```

### **å¯¹æ¯”æ–¹æ¡ˆï¼šKnative ç›‘æ§**

```bash
# æŸ¥çœ‹ Knative ç›‘æ§èƒ½åŠ›å’Œé™åˆ¶
./scripts/knative-monitoring-demo.sh
```

## ğŸ” **å…·ä½“ç›‘æ§æŒ‡æ ‡è¯´æ˜**

### **å…³é”®ä¸šåŠ¡æŒ‡æ ‡**

#### **1. æ¶ˆæ¯å †ç§¯çŠ¶æ€**
```
æ¶ˆæ¯å †ç§¯ = å‘å¸ƒæ€»æ•° - æ¥æ”¶æ€»æ•°

âœ… è´Ÿæ•°: æ¶ˆè´¹é¢†å…ˆï¼ˆå¥åº·ï¼‰
âš ï¸  æ­£æ•°: å­˜åœ¨ç§¯å‹ï¼ˆéœ€è¦å…³æ³¨ï¼‰
ğŸš¨ å¤§æ­£æ•°: ä¸¥é‡ç§¯å‹ï¼ˆéœ€è¦å¤„ç†ï¼‰
```

#### **2. æ¶ˆè´¹é€Ÿåº¦**
```
æ¶ˆè´¹é€Ÿåº¦ = (å½“å‰æ¥æ”¶æ•° - ä¹‹å‰æ¥æ”¶æ•°) / æ—¶é—´å·®

æ­£å¸¸èŒƒå›´: æ ¹æ®ä¸šåŠ¡éœ€æ±‚ç¡®å®š
ç›‘æ§é¢‘ç‡: å»ºè®®æ¯åˆ†é’Ÿæ£€æŸ¥
```

#### **3. å»¶è¿Ÿåˆ†å¸ƒ**
```
â‰¤5ms: è¶…å¿«å¤„ç†
â‰¤50ms: æ­£å¸¸å¤„ç†
â‰¤100ms: å¯æ¥å—
>100ms: éœ€è¦ä¼˜åŒ–
```

## ğŸ“‹ **æ•…éšœæ’æŸ¥æµç¨‹**

### **å‘ç°é—®é¢˜æ—¶çš„æ£€æŸ¥é¡ºåº**

1. **å¿«é€ŸçŠ¶æ€æ£€æŸ¥**
   ```bash
   ./scripts/quick-monitor.sh
   ```

2. **Dapr è¯¦ç»†åˆ†æ**
   ```bash
   echo "1" | ./scripts/dapr-metrics-monitor.sh
   ```

3. **æŸ¥çœ‹åº”ç”¨æ—¥å¿—**
   ```bash
   kubectl logs -n dapr-demo -l dapr.io/sidecar-injected=true -c app -f
   ```

4. **Redis åº•å±‚åˆ†æï¼ˆå¦‚æœéœ€è¦ï¼‰**
   ```bash
   ./scripts/monitor-redis-streams.sh
   ```

5. **ç½‘ç»œè¿æ¥æ£€æŸ¥**
   ```bash
   echo "4" | ./scripts/monitor-dapr-metrics.sh
   ```

## ğŸ¯ **ä¸åŒéœ€æ±‚çš„æœ€ä½³é€‰æ‹©**

### **æ—¥å¸¸è¿ç»´ç›‘æ§**
```bash
# æ¨èï¼šå¿«é€Ÿæ£€æŸ¥
echo "4" | ./scripts/dapr-metrics-monitor.sh
```

### **æ€§èƒ½è°ƒä¼˜åˆ†æ**
```bash
# æ¨èï¼šè¯¦ç»†åˆ†æ + æ€§èƒ½æµ‹è¯•
echo "1" | ./scripts/dapr-metrics-monitor.sh
echo "3" | ./scripts/dapr-metrics-monitor.sh
```

### **ç”Ÿäº§æ•…éšœæ’æŸ¥**
```bash
# æ¨èï¼šç»„åˆä½¿ç”¨
./scripts/quick-monitor.sh
echo "1" | ./scripts/dapr-metrics-monitor.sh
./scripts/monitor-redis-streams.sh  # å¦‚æœæœ‰ redis-cli
```

### **å®æ—¶ç›‘æ§**
```bash
# æ¨èï¼šå®æ—¶ç›‘æ§æ¨¡å¼
echo "2" | ./scripts/dapr-metrics-monitor.sh
```

## ğŸ“š **ç›¸å…³æ–‡æ¡£**

### **è¯¦ç»†å¯¹æ¯”åˆ†æ**
- `docs/knative-vs-dapr-monitoring-comparison.md` - å®Œæ•´æŠ€æœ¯å¯¹æ¯”
- `docs/dapr-metrics-monitoring-guide.md` - Daprç›‘æ§è¯¦ç»†æŒ‡å—
- `docs/monitoring-capabilities-final-comparison.md` - æœ€ç»ˆç»“è®ºå’Œå»ºè®®

### **å¿«é€Ÿå‚è€ƒ**
- `scripts/README-monitoring.md` - ç›‘æ§å·¥å…·å¯¹æ¯”è¡¨
- `scripts/dapr-demo-summary.md` - Daprè§£å†³æ–¹æ¡ˆæ€»ç»“

## ğŸ‰ **æ€»ç»“**

**å¯¹äºæ‚¨çš„å…·ä½“éœ€æ±‚ï¼ˆç›‘æ§æ¶ˆæ¯å †ç§¯å’Œæ¶ˆè´¹é€Ÿåº¦ï¼‰**ï¼š

### **æœ€ä½³æ–¹æ¡ˆï¼šä½¿ç”¨ Dapr ç›‘æ§**
```bash
# ä¸€é”®è·å¾—æ‰€éœ€çš„æ‰€æœ‰ç›‘æ§æŒ‡æ ‡
echo "4" | ./scripts/dapr-metrics-monitor.sh
```

### **å…³é”®ä¼˜åŠ¿**
- âœ… **å¼€ç®±å³ç”¨**ï¼šæ— éœ€é¢å¤–å¼€å‘
- âœ… **ç²¾ç¡®æŒ‡æ ‡**ï¼šç›´æ¥è®¡ç®—æ¶ˆæ¯å †ç§¯
- âœ… **å®æ—¶ç›‘æ§**ï¼šæ”¯æŒæŒç»­ç›‘æ§
- âœ… **æ ‡å‡†æ ¼å¼**ï¼šPrometheus å…¼å®¹
- âœ… **ç”Ÿäº§å°±ç»ª**ï¼šå®Œæ•´çš„ç›‘æ§è§£å†³æ–¹æ¡ˆ

**æ‚¨ç°åœ¨å°±å¯ä»¥ä½¿ç”¨è¿™äº›å·¥å…·æ¥ç›‘æ§æ‚¨çš„æ¶ˆæ¯é˜Ÿåˆ—æ€§èƒ½ï¼** 